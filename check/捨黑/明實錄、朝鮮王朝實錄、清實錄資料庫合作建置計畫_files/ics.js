var GA='<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>';GA+='<script type="text/javascript">try {_uacct = "UA-1722543-4";urchinTracker();} catch(err) {}</script>';document.write(GA);
var ICS_DATABASE_URL="http://char.iis.sinica.edu.tw/API/render.aspx";if(document.URL.indexOf("https://")!==-1){ICS_DATABASE_URL="https://char.iis.sinica.edu.tw/API/render.aspx"}var ICS_FONT_COLOR="black";var ICS_FONT_SIZE=12;var ICS_FONT_PLACE="Mingliu";var ICS_BG_TRANS="ture";var ICS_ALT_PREFIX=String.fromCharCode(0x25CF)+String.fromCharCode(0xFF1D);var CONST_TYPE_CONJOINER=0;var CONST_TYPE_MULTIPLIER=1;var CONST_TYPE_SPANDELIMITER=2;var CONST_TYPE_BRACKETS=3;var Use_URL=window.location.href;var ExprArray=[];var No_Expr=0;var Operators=[[0xF6A3,0xF6A4,0xF6A5],[0xF6A6,0xF6A7,0xF6A8,0xF6A9,0xF6AA,0xF6AB,0xF6AC,0xF6AD],[0xF6AE]];var bracketArray=[];function ICSImage_toNode(){var wind=this.expr.indexOf("");var encoded="";var imgSize,node;if(wind>0){var wind_bef="";var wind_tmp="";var wind_aft="";var appNum=1;var windURL="http://char.iis.sinica.edu.tw/API/render_wind.aspx";wind_bef=this.expr.substring(1,wind);wind_tmp=this.expr.substring(wind+1,this.expr.length-1);if(wind_tmp.indexOf(";")>0){appNum=wind_tmp.substr(wind_tmp.indexOf(";")+1);wind_aft=wind_tmp.substring(0,wind_tmp.indexOf(";"))}else{wind_aft=wind_tmp}imgSize=(this.size*4)/3;node=document.createElement("IMG");node.setAttribute("SRC",windURL+"?word="+encodeURI(wind_bef)+"&from="+encodeURI(wind_aft)+"&appNum="+appNum+"&c="+this.color+"&s="+this.size);node.setAttribute("BORDER","0");node.setAttribute("style","vertical-align:text-bottom");node.setAttribute("ALT",""+wind_bef+""+wind_tmp+"");return node}else{var i;for(i=0;i<this.expr.length;i++){encoded+=this.expr.charCodeAt(i).toString(16)+","}ExprArray[No_Expr]=[this.expr];No_Expr++;imgSize=(this.size*4)/3;node=document.createElement("IMG");node.setAttribute("SRC",this.baseURL+"?word="+encoded+"&c="+this.color+"&s="+this.size+"&f="+this.f+"&bg="+this.bg);node.setAttribute("BORDER","0");node.setAttribute("style","vertical-align:text-bottom");node.setAttribute("ALT",this.expr);return node}}function ICSImage(expr){this.expr=expr;this.baseURL=ICS_DATABASE_URL;this.size=ICS_FONT_SIZE;this.color=ICS_FONT_COLOR;this.f=ICS_FONT_PLACE;this.altPrefix=ICS_ALT_PREFIX;this.toNode=ICSImage_toNode;this.bg=ICS_BG_TRANS}function isOperator(code){return(code>=0xF6A3&&code<=0xF6AF)}function getOperatorType(code){var optype,i,j;for(i=0;i<Operators.length;i++){for(j=0;j<Operators[i].length;j++){if(code===Operators[i][j]){optype=i;break}}}return optype}function isPrivateUsed(code){return(code>=0xE000&&code<=0xF848)}function containsICS(text){var r=false;var i;for(i=0;i<text.length;i++){if(isPrivateUsed(text.charCodeAt(i))){r=true;break}}return r}function isBrackets(code){return(code===bracketArray[0])}function containsBrackets(text){var j;for(j=0;j<text.length;j++){if(text.charCodeAt(j)===bracketArray[0]){return true}}return false}function cmbTxtNodes(node){var i,nodes=node.childNodes,nd,p;if(!nodes){return}for(i=0;i<nodes.length;i++){if((nd=nodes[i]).nodeType===3){if(p){p.nodeValue+=nd.nodeValue;node.removeChild(nd)}else{p=nd}}else{p=null}}for(i=0;i<nodes.length;i++){cmbTxtNodes(nodes[i])}}function processTextNode(text,returnTag){if(typeof(text)==='undefined'){return}var oldText=text;var newText="";var len=oldText.length;var i=0;var nodeArray=[];var encodedexpr="";var node,imgString,imgnode,img;for(i=0;i<len;i++){var ch=oldText.charAt(i);var code=oldText.charCodeAt(i);var start=i;var stop=i;var expr="";var error=false;var isBracket=false;if(isOperator(code)||isBrackets(code)){var type=getOperatorType(code);if(type===CONST_TYPE_CONJOINER){if(((i-1)>=0&&getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_MULTIPLIER)||getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_CONJOINER||getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_SPANDELIMITER){error=true}else if(((i+1)<len&&getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_CONJOINER)||getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_SPANDELIMITER){error=true}else if((i-2)>=0&&getOperatorType(oldText.charCodeAt(i-2))===CONST_TYPE_MULTIPLIER){start=i-2;newText=newText.substring(0,newText.length-1)}else{start=i-1;newText=newText.substring(0,newText.length-1)}if(!error){stop=i;while((((stop+1)<len)&&isOperator(oldText.charCodeAt(stop)))||getOperatorType(oldText.charCodeAt(stop+1))===CONST_TYPE_CONJOINER){stop++}error=false}}else if(type===CONST_TYPE_MULTIPLIER){if(((i+1)<len&&getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_MULTIPLIER)||getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_CONJOINER||getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_SPANDELIMITER){error=true}else if((i-1)>=0&&getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_MULTIPLIER){error=true}if(!error){stop=i+1;error=false}}else if(type===CONST_TYPE_SPANDELIMITER){if(((i+1)<len&&(getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_CONJOINER))||(getOperatorType(oldText.charCodeAt(i+1))===CONST_TYPE_SPANDELIMITER)){error=true}else if(((i-1)>=0&&getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_MULTIPLIER)||getOperatorType(oldText.charCodeAt(i-1))===CONST_TYPE_CONJOINER||oldText.charCodeAt(i-1)===63150){error=true}if(!error){stop=oldText.indexOf(String.fromCharCode(0xF6AF),i);if(stop<0){stop=start;error=true}else if(stop>start+15){stop=start+1;error=true}}}else if(type===CONST_TYPE_BRACKETS){isBracket=true;stop=oldText.indexOf(String.fromCharCode(bracketArray[1]),i);if(stop<0){stop=start;error=true}else if(stop>start+10){stop=start+1;error=true}}if(!error){if(isBracket){expr=oldText.substring(start+1,stop);if(expr.indexOf("+")>0){expr=expr.replace("+","")}isBracket=false}else{expr=oldText.substring(start,stop+1)}if(newText!==""){node=document.createTextNode(newText);nodeArray.length++;nodeArray[nodeArray.length-1]=node}if(returnTag===true){for(i=0;i<expr.length;i++){encodedexpr+=expr.charCodeAt(i).toString(16)+","}imgString="<img src='"+ICS_DATABASE_URL+"?word="+encodedexpr+"&c="+ICS_FONT_COLOR+"&s="+ICS_FONT_SIZE+"'/>";imgnode=document.createTextNode(imgString)}else{img=new ICSImage(expr);imgnode=img.toNode()}nodeArray.length++;nodeArray[nodeArray.length-1]=imgnode}newText="";i=stop}else if(isPrivateUsed(code)&&!isOperator(code)&&!isOperator(oldText.charCodeAt(i-1))&&!isOperator(oldText.charCodeAt(i+1))){expr=ch;if(newText!==""){node=document.createTextNode(newText);nodeArray.length++;nodeArray[nodeArray.length-1]=node}if(returnTag===true){encodedexpr="";for(i=0;i<expr.length;i++){encodedexpr+=expr.charCodeAt(i).toString(16)+","}imgString="<img src='"+ICS_DATABASE_URL+"?word="+encodedexpr+"&c="+ICS_FONT_COLOR+"&s="+ICS_FONT_SIZE+"'/>";imgnode=document.createTextNode(imgString)}else{img=new ICSImage(expr);imgnode=img.toNode()}nodeArray.length++;nodeArray[nodeArray.length-1]=imgnode;newText=""}else{newText+=ch}}if(newText.length>0){node=document.createTextNode(newText);nodeArray.length++;nodeArray[nodeArray.length-1]=node}return nodeArray}function traverse(element,isCmdTxtNode){if(element.type==="textarea"){return}var nodes=element.childNodes;var node,nextNode,shift,arrLen;var NODE_TEXT=3;var nodesLen,i;if(nodes!==undefined){nodesLen=nodes.length}else{nodesLen=0}for(i=0;i<nodesLen;i++){node=nodes[i];if(!node){continue}var j=i+1;nextNode=(j===nodesLen)?null:nodes[j];if(node.nodeType===NODE_TEXT){if(isCmdTxtNode){cmbTxtNodes(element);isCmdTxtNode=false}if(containsICS(node.nodeValue)||containsBrackets(node.nodeValue)){element.removeChild(node);var arr=processTextNode(node.nodeValue,false);arrLen=arr.length;shift=((arrLen>1)?arrLen-1:0);nodesLen+=shift;i+=shift;for(j=0;j<arrLen;j++){if(nextNode){element.insertBefore(arr[j],nextNode)}else{element.appendChild(arr[j])}}element.innerHTML=element.innerHTML}}else{if(node.nodeName.toLowerCase()!=="script"){traverse(node,isCmdTxtNode)}}}}function processPage(setColor,setSize,left,right,setPlace,setBg){if(left!==undefined&&right!==undefined){bracketArray[0]=left.charCodeAt(0);bracketArray[1]=right.charCodeAt(0);Operators[3]=bracketArray}if(setColor!==undefined){setColor=setColor.replace(/[#]/g,"");ICS_FONT_COLOR=setColor}if(setSize!==undefined){ICS_FONT_SIZE=setSize}if(setPlace!==undefined){ICS_FONT_PLACE=setPlace}if(setBg!==undefined){ICS_BG_TRANS=setBg}traverse(document.body,true)}function processText(string,setColor,setSize,setPlace,setBg){if(setColor!==undefined){setColor=setColor.replace(/[#]/g,"");ICS_FONT_COLOR=setColor}if(setSize!==undefined){ICS_FONT_SIZE=setSize}if(setPlace!==undefined){ICS_FONT_PLACE=setPlace}if(setBg!==undefined){ICS_BG_TRANS=setBg}var returnTag=true;var returnText="";var arr=processTextNode(string,returnTag);var i;for(i=0;i<arr.length;i++){returnText+=arr[i].nodeValue}return returnText}function processObject(obj,setColor,setSize,left,right,setPlace,setBg){if(left!==undefined&&right!==undefined){bracketArray[0]=left.charCodeAt(0);bracketArray[1]=right.charCodeAt(0);Operators[3]=bracketArray}if(setColor!==undefined){setColor=setColor.replace(/[#]/g,"");ICS_FONT_COLOR=setColor}if(setSize!==undefined){ICS_FONT_SIZE=setSize}if(setPlace!==undefined){ICS_FONT_PLACE=setPlace}if(setBg!==undefined){ICS_BG_TRANS=setBg}var i;if(obj.length>0){for(i=0;i<obj.length;i++){traverse(obj[i],true)}}else{traverse(obj,true)}}